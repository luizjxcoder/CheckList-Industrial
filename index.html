<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Checklist - Auditoria Industrial</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&display=swap');
        body { font-family: 'Montserrat', sans-serif; }
        
        .checklist-item {
            transition: all 0.3s ease;
        }
        
        .checklist-item:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .checked {
            background: linear-gradient(135deg, #d1fae5, #a7f3d0);
            color: #065f46;
            border: 1px solid #34d399;
        }
        
        .dark .checked {
            background: linear-gradient(135deg, #064e3b, #047857);
            color: #a7f3d0;
            border: 1px solid #10b981;
        }
        
        .progress-bar {
            transition: width 0.5s ease;
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="min-h-screen bg-white dark:bg-slate-800 transition-colors duration-300" style="background-color: white;" data-dark-bg="#1E293B">
    <div class="container mx-auto px-2 sm:px-4 py-4 sm:py-8 max-w-4xl">
        <!-- Dark Mode Toggle -->
        <div class="fixed top-4 right-4 z-40">
            <button onclick="toggleDarkMode()" class="bg-white dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-800 dark:text-gray-200 p-3 rounded-full shadow-xl border border-gray-200 dark:border-gray-600 transition-all transform hover:scale-105" id="dark-mode-toggle">
                <span id="dark-mode-icon">üåô</span>
            </button>
        </div>

        <!-- Header -->
        <div class="bg-white dark:bg-slate-700 rounded-xl sm:rounded-2xl shadow-xl border border-gray-200 dark:border-slate-600 p-4 sm:p-6 lg:p-8 mb-4 sm:mb-8" style="background-color: white;" data-dark-bg="#1A2538">
            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 sm:mb-6">
                <div class="mb-4 sm:mb-0">
                    <h1 class="text-2xl sm:text-3xl font-bold text-gray-800 dark:text-white mb-2" style="color: #1f2937;" data-dark-text="white">Auditoria M√°quina Parada - RM4</h1>
                    <p class="text-sm sm:text-base text-gray-600 dark:text-white" style="color: #4b5563;" data-dark-text="white">Check List de auditoria</p>
                </div>
                <div class="text-center sm:text-right">
                    <div class="text-xl sm:text-2xl font-bold text-purple-600 dark:text-purple-300" id="progress-text">0%</div>
                    <div class="text-xs sm:text-sm text-gray-500 dark:text-white" style="color: #6b7280;" data-dark-text="white">Conclu√≠do</div>
                </div>
            </div>
            
            <!-- Progress Bar -->
            <div class="w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2 sm:h-3 mb-4">
                <div class="progress-bar bg-gradient-to-r from-indigo-500 to-purple-600 h-2 sm:h-3 rounded-full" id="progress-bar" style="width: 0%"></div>
            </div>
            
            <!-- Stats -->
            <div class="grid grid-cols-3 gap-2 sm:gap-3 text-center">
                <div class="bg-white dark:bg-slate-600 border border-gray-200 dark:border-slate-500 rounded-lg p-2 sm:p-2.5 relative overflow-hidden" style="background-color: white;" data-dark-bg="#475569">
                    <div class="absolute inset-0 bg-gradient-to-r from-gray-100 to-gray-200 dark:from-slate-700 dark:to-slate-600 opacity-10"></div>
                    <div class="relative">
                        <div class="text-sm sm:text-base font-bold text-gray-800 dark:text-white mb-1" id="total-items" style="color: #1f2937;" data-dark-text="white">0</div>
                        <div class="text-xs text-gray-600 dark:text-white" style="color: #4b5563;" data-dark-text="white">Total</div>
                        <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1 mt-1">
                            <div class="bg-gray-500 dark:bg-gray-400 h-1 rounded-full transition-all duration-500" id="total-bar" style="width: 100%"></div>
                        </div>
                    </div>
                </div>
                <div class="bg-white dark:bg-slate-600 border border-gray-200 dark:border-slate-500 rounded-lg p-2 sm:p-2.5 relative overflow-hidden" style="background-color: white;" data-dark-bg="#475569">
                    <div class="absolute inset-0 bg-gradient-to-r from-green-100 to-emerald-200 dark:from-slate-700 dark:to-slate-600 opacity-10"></div>
                    <div class="relative">
                        <div class="text-sm sm:text-base font-bold text-green-600 dark:text-green-300 mb-1" id="completed-items" style="color: #059669;" data-dark-text="white">0</div>
                        <div class="text-xs text-gray-600 dark:text-white" style="color: #4b5563;" data-dark-text="white">Conclu√≠dos</div>
                        <div class="w-full bg-green-200 dark:bg-green-800 rounded-full h-1 mt-1">
                            <div class="bg-green-500 dark:bg-green-400 h-1 rounded-full transition-all duration-500" id="completed-bar" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
                <div class="bg-white dark:bg-slate-600 border border-orange-200 dark:border-slate-500 rounded-lg p-2 sm:p-2.5 relative overflow-hidden" style="background-color: white;" data-dark-bg="#475569">
                    <div class="absolute inset-0 bg-gradient-to-r from-orange-100 to-amber-200 dark:from-slate-700 dark:to-slate-600 opacity-10"></div>
                    <div class="relative">
                        <div class="text-sm sm:text-base font-bold text-orange-600 dark:text-orange-300 mb-1" id="pending-items" style="color: #d97706;" data-dark-text="white">0</div>
                        <div class="text-xs text-gray-600 dark:text-white" style="color: #4b5563;" data-dark-text="white">Pendentes</div>
                        <div class="w-full bg-orange-200 dark:bg-orange-800 rounded-full h-1 mt-1">
                            <div class="bg-orange-500 dark:bg-orange-400 h-1 rounded-full transition-all duration-500" id="pending-bar" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Checklist Items -->
        <div class="space-y-4" id="checklist-container">
            <!-- Items will be generated by JavaScript -->
        </div>

        <!-- Action Buttons -->
        <div class="mt-4 sm:mt-8 flex flex-row sm:flex-row gap-2 sm:gap-4 justify-center">
            <button onclick="resetChecklist()" class="bg-gradient-to-r from-slate-500 to-gray-600 hover:from-slate-600 hover:to-gray-700 text-white px-3 sm:px-8 py-2 sm:py-3 rounded-lg sm:rounded-xl font-semibold transition-all transform hover:scale-105 shadow-lg text-sm sm:text-base">
                <span class="sm:hidden">üîÑ</span>
                <span class="hidden sm:inline">üîÑ Resetar Checklist</span>
            </button>
            <button onclick="exportReport()" class="bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-600 hover:to-purple-700 text-white px-3 sm:px-8 py-2 sm:py-3 rounded-lg sm:rounded-xl font-semibold transition-all transform hover:scale-105 shadow-lg text-sm sm:text-base">
                <span class="sm:hidden">üìä</span>
                <span class="hidden sm:inline">üìä Exportar Relat√≥rio</span>
            </button>
            <button onclick="printChecklist()" class="bg-gradient-to-r from-emerald-500 to-teal-600 hover:from-emerald-600 hover:to-teal-700 text-white px-3 sm:px-8 py-2 sm:py-3 rounded-lg sm:rounded-xl font-semibold transition-all transform hover:scale-105 shadow-lg text-sm sm:text-base">
                <span class="sm:hidden">üñ®Ô∏è</span>
                <span class="hidden sm:inline">üñ®Ô∏è Imprimir</span>
            </button>
        </div>

        <!-- Item Details Modal -->
        <div id="item-modal" class="fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm hidden items-center justify-center z-50 p-2 sm:p-4">
            <div class="bg-white dark:bg-slate-700 rounded-2xl sm:rounded-3xl p-4 sm:p-6 lg:p-8 max-w-5xl w-full shadow-2xl border border-gray-200 dark:border-slate-600 max-h-screen overflow-y-auto" style="background-color: white;" data-dark-bg="#1A2538">
                <div class="flex justify-between items-center mb-4 sm:mb-6">
                    <h2 class="text-xl sm:text-2xl lg:text-3xl font-bold text-gray-800 dark:text-white" id="modal-title">Detalhes do Item</h2>
                    <button onclick="closeItemModal()" class="text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 text-2xl sm:text-3xl transition-colors hover:rotate-90 transform duration-300">&times;</button>
                </div>
                <div id="item-details-content"></div>
                <div class="mt-6 sm:mt-8 text-center">
                    <button onclick="closeItemModal()" class="bg-gradient-to-r from-slate-500 to-gray-600 hover:from-slate-600 hover:to-gray-700 text-white px-6 sm:px-8 py-3 rounded-xl font-semibold transition-all transform hover:scale-105 shadow-lg text-sm sm:text-base">
                        Fechar
                    </button>
                </div>
            </div>
        </div>

        <!-- Report Modal -->
        <div id="report-modal" class="fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm hidden items-center justify-center z-50 p-2 sm:p-4">
            <div class="bg-white dark:bg-slate-700 rounded-2xl sm:rounded-3xl p-4 sm:p-6 lg:p-8 max-w-4xl w-full shadow-2xl border border-gray-200 dark:border-slate-600 max-h-screen overflow-y-auto" style="background-color: white;" data-dark-bg="#1A2538">
                <div class="flex justify-between items-center mb-4 sm:mb-6">
                    <h2 class="text-xl sm:text-2xl lg:text-3xl font-bold text-gray-800 dark:text-white">Relat√≥rio de Auditoria</h2>
                    <button onclick="closeModal()" class="text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 text-2xl sm:text-3xl transition-colors hover:rotate-90 transform duration-300">&times;</button>
                </div>
                <div id="report-content"></div>
                <div class="mt-6 sm:mt-8 text-center">
                    <button onclick="closeModal()" class="bg-gradient-to-r from-emerald-500 to-teal-600 hover:from-emerald-600 hover:to-teal-700 text-white px-6 sm:px-8 py-3 rounded-xl font-semibold transition-all transform hover:scale-105 shadow-lg text-sm sm:text-base">
                        Fechar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Checklist items data with detailed information
        const checklistItems = [
            { 
                id: 1, 
                category: "Mandril", 
                item: "Mandril", 
                type: "",
                criteria: "Isento de graxa",
                defect: "Qualidade Superficial - Mancha",
                inspection: "Visual",
                action: "Realizar a limpeza com pano seco."
            },
            { 
                id: 2, 
                category: "Mandril", 
                item: "Mandril enrolador e desenrolador", 
                type: "",
                criteria: "Isento de graxa",
                defect: "Qualidade Superficial - Mancha",
                inspection: "Visual",
                action: "Realizar a limpeza com pano seco."
            },
            { 
                id: 3, 
                category: "Edge Leveller", 
                item: "Edge Leveller", 
                type: "",
                criteria: "Isento de rebarbas, filetes e cavacos",
                defect: "Qualidade Superficial - Marca de cavaco",
                inspection: "Visual",
                action: "Remover as rebarbas e limpar com pano seco"
            },
            { 
                id: 4, 
                category: "Edge Leveller", 
                item: "Conjunto do edge leveller", 
                type: "",
                criteria: "Isento de rebarbas, filetes e cavacos",
                defect: "Qualidade Superficial - Marca de cavaco",
                inspection: "Visual",
                action: "Remover as rebarbas e limpar com pano seco"
            },
            { 
                id: 5, 
                category: "Edge Leveller", 
                item: "Inspe√ß√£o - Edge Leveller", 
                type: "",
                criteria: "Isento de folga nos roletes ao contato manual",
                defect: "Plissamento e Qualidade de corte",
                inspection: "Tato",
                action: "Acionar manuten√ß√£o para ajuste na folga"
            },
            { 
                id: 6, 
                category: "Edge Leveller", 
                item: "Folga no ajuste do edge leveller", 
                type: "",
                criteria: "Isento de folga nos roletes ao contato manual",
                defect: "Plissamento e Qualidade de corte",
                inspection: "Tato",
                action: "Acionar manuten√ß√£o para ajuste na folga"
            },
            { 
                id: 7, 
                category: "Caminho do Alum√≠nio", 
                item: "Caminho do Alum√≠nio - Sa√≠da", 
                type: "",
                criteria: "Isento de rebarbas, filetes e cavacos",
                defect: "Qualidade Superficial - Marca de cavaco",
                inspection: "Visual",
                action: "Remover as rebarbas com ferramenta adequada"
            },
            { 
                id: 8, 
                category: "Estrutura", 
                item: "Estrutura do pressure roll e pinch Roll 5", 
                type: "",
                criteria: "Isento de rebarbas, filetes e cavacos",
                defect: "Qualidade Superficial - Marca de cavaco",
                inspection: "Visual",
                action: "Remover as rebarbas com ferramenta adequada"
            },
            { 
                id: 9, 
                category: "Limpeza", 
                item: "Limpeza das barras do Peabody", 
                type: "",
                criteria: "Sem finos de alum√≠nio",
                defect: "Aplica√ß√£o de lubrificante - Gramatura",
                inspection: "Visual",
                action: "Realizar a limpeza com pano seco."
            },
            { 
                id: 10, 
                category: "Limpeza", 
                item: "Barra superior e inferior", 
                type: "",
                criteria: "Sem finos de alum√≠nio",
                defect: "Aplica√ß√£o de lubrificante - Gramatura",
                inspection: "Visual",
                action: "Realizar a limpeza com pano seco."
            },
            { 
                id: 11, 
                category: "Sistema de Inspe√ß√£o", 
                item: "Sistema de inspe√ß√£o", 
                type: "",
                criteria: "Sem ac√∫mulo de √≥leo e finos de alum√≠nio",
                defect: "Qualidade superficial",
                inspection: "Visual",
                action: "Realizar a limpeza com pano seco."
            },
            { 
                id: 12, 
                category: "Sistema de Inspe√ß√£o", 
                item: "C√¢meras e barras de led", 
                type: "",
                criteria: "Sem ac√∫mulo de √≥leo e finos de alum√≠nio",
                defect: "Qualidade superficial",
                inspection: "Visual",
                action: "Realizar a limpeza com pano seco."
            },
            { 
                id: 13, 
                category: "Caminho do Alum√≠nio", 
                item: "Caminho do Alum√≠nio - Mesas", 
                type: "",
                criteria: "Isento de rebarbas, filetes e cavacos. Filetes de nylon da mesa n√£o podem encostar no rolete",
                defect: "Qualidade Superficial - Marca de cavaco",
                inspection: "Visual",
                action: "Realizar a limpeza com pano seco."
            },
            { 
                id: 14, 
                category: "Caminho do Alum√≠nio", 
                item: "Mesa da Drum shear e mesa de inspe√ß√£o", 
                type: "",
                criteria: "Isento de rebarbas, filetes e cavacos. Filetes de nylon da mesa n√£o podem encostar no rolete",
                defect: "Qualidade Superficial - Marca de cavaco",
                inspection: "Visual",
                action: "Realizar a limpeza com pano seco."
            },
            { 
                id: 15, 
                category: "Cal√ßos", 
                item: "Cal√ßos", 
                type: "",
                criteria: "N√£o podem estar com parafusos soltos ou sobrepostos, tamb√©m devem estar isentos de rebarbas, filetes e cavacos",
                defect: "Qualidade superficial - Amassamento",
                inspection: "Visual",
                action: "Realizar a limpeza com pano seco."
            },
            { 
                id: 16, 
                category: "Cal√ßos", 
                item: "Cal√ßos do conveyor e Coil car", 
                type: "",
                criteria: "N√£o podem estar com parafusos soltos ou sobrepostos, tamb√©m devem estar isentos de rebarbas, filetes e cavacos",
                defect: "Qualidade superficial - Amassamento",
                inspection: "Visual",
                action: "Realizar a limpeza com pano seco."
            },
            { 
                id: 17, 
                category: "CNC", 
                item: "CNC", 
                type: "",
                criteria: "Isento de finos, rebarbas, filetes e cavacos. Faca n√£o deve apresentar dentes",
                defect: "Plissamento e Qualidade de corte",
                inspection: "Visual",
                action: "Realizar a limpeza com pano seco."
            },
            { 
                id: 18, 
                category: "CNC", 
                item: "Facas e borrachas", 
                type: "",
                criteria: "Isento de finos, rebarbas, filetes e cavacos. Faca n√£o deve apresentar dentes",
                defect: "Plissamento e Qualidade de corte",
                inspection: "Visual",
                action: "Realizar a limpeza com pano seco."
            },
            { 
                id: 19, 
                category: "Coil Car", 
                item: "Coil car de sa√≠da", 
                type: "",
                criteria: "Isento de finos, rebarbas e cavacos. EVA em boas condi√ß√µes",
                defect: "Qualidade superficial - Amassamento",
                inspection: "Visual",
                action: "Realizar a limpeza com pano seco e troca do EVA."
            },
            { 
                id: 20, 
                category: "Coil Car", 
                item: "Coil car de sa√≠da", 
                type: "",
                criteria: "Isento de finos, rebarbas e cavacos. EVA em boas condi√ß√µes",
                defect: "Qualidade superficial - Amassamento",
                inspection: "Visual",
                action: "Realizar a limpeza com pano seco e troca do EVA."
            },
            { 
                id: 21, 
                category: "Foto C√©lula", 
                item: "Foto C√©lula", 
                type: "",
                criteria: "Isento de finos, rebarbas, filetes e cavacos",
                defect: "Bobinamento irregular",
                inspection: "Visual",
                action: "Realizar a limpeza com pano seco."
            },
            { 
                id: 22, 
                category: "Foto C√©lula", 
                item: "Espelho", 
                type: "",
                criteria: "Isento de finos, rebarbas, filetes e cavacos",
                defect: "Bobinamento irregular",
                inspection: "Visual",
                action: "Realizar a limpeza com pano seco."
            }
        ];

        let checkedItems = new Set();

        // Initialize the checklist
        function initializeChecklist() {
            const container = document.getElementById('checklist-container');
            const categories = {};
            
            // Group items by category
            checklistItems.forEach(item => {
                if (!categories[item.category]) {
                    categories[item.category] = [];
                }
                categories[item.category].push(item);
            });

            // Create HTML for each category
            Object.keys(categories).forEach(category => {
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'bg-white dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-xl shadow-lg p-4 sm:p-6 fade-in';
                categoryDiv.style.backgroundColor = 'white';
                categoryDiv.setAttribute('data-dark-bg', '#1F2937');
                
                let categoryHTML = `
                    <h3 class="text-lg sm:text-xl font-semibold text-gray-800 dark:text-white mb-3 sm:mb-4 border-b border-gray-200 dark:border-gray-600 pb-2" style="color: #1f2937;" data-dark-text="white">
                        üìã ${category}
                    </h3>
                    <div class="space-y-2 sm:space-y-3">
                `;
                
                categories[category].forEach(item => {
                    categoryHTML += `
                        <div class="checklist-item bg-white dark:bg-slate-600 border border-gray-200 dark:border-slate-500 rounded-lg p-3 sm:p-4 cursor-pointer hover:border-indigo-300 dark:hover:border-indigo-600 transition-all" 
                             id="item-${item.id}" style="background-color: white;" data-dark-bg="#1F2937">
                            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-2 sm:space-y-0">
                                <div class="flex items-center space-x-3" onclick="showItemDetails(${item.id})">
                                    <div class="w-5 h-5 sm:w-6 sm:h-6 border-2 border-gray-300 dark:border-slate-400 bg-white dark:bg-slate-500 rounded-md flex items-center justify-center flex-shrink-0 hover:border-indigo-400 dark:hover:border-indigo-500 transition-colors" 
                                         onclick="event.stopPropagation(); toggleItem(${item.id})" id="checkbox-${item.id}" style="background-color: white; border-color: #d1d5db;" data-dark-bg="#1F2937" data-dark-border="#94a3b8">
                                        <span class="text-white font-bold hidden text-sm sm:text-base" id="check-${item.id}">‚úì</span>
                                    </div>
                                    <div class="flex-1 min-w-0">
                                        <div class="font-medium text-gray-800 dark:text-white text-sm sm:text-base break-words" style="color: #1f2937;" data-dark-text="white">${item.item}</div>
                                        ${item.type ? `<div class="text-xs sm:text-sm text-indigo-600 dark:text-indigo-300 font-medium" data-dark-text="white">${item.type}</div>` : ''}
                                    </div>
                                </div>
                                <div class="flex items-center justify-between sm:justify-end space-x-2 ml-8 sm:ml-0">
                                    <button onclick="showItemDetails(${item.id})" class="text-blue-500 hover:text-blue-700 dark:text-purple-300 dark:hover:text-purple-100 text-xs sm:text-sm font-bold" style="text-shadow: 0 1px 2px rgba(0,0,0,0.3); color: #3b82f6;" data-dark-text="#c4b5fd">
                                        üìã Detalhes
                                    </button>
                                    <div class="text-gray-400">
                                        <span class="hidden" id="status-${item.id}">‚úÖ</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                categoryHTML += '</div></div>';
                categoryDiv.innerHTML = categoryHTML;
                container.appendChild(categoryDiv);
            });

            updateStats();
        }

        // Toggle item checked state
        function toggleItem(itemId) {
            const item = document.getElementById(`item-${itemId}`);
            const checkbox = document.getElementById(`checkbox-${itemId}`);
            const check = document.getElementById(`check-${itemId}`);
            const status = document.getElementById(`status-${itemId}`);
            const isDark = document.documentElement.classList.contains('dark');
            
            if (checkedItems.has(itemId)) {
                // Uncheck item
                checkedItems.delete(itemId);
                item.classList.remove('checked');
                if (isDark) {
                    item.style.backgroundColor = '#1F2937';
                    checkbox.style.backgroundColor = '#1F2937';
                    checkbox.style.borderColor = '#94a3b8';
                } else {
                    item.style.backgroundColor = 'white';
                    checkbox.style.backgroundColor = 'white';
                    checkbox.style.borderColor = '#d1d5db';
                }
                checkbox.classList.remove('bg-emerald-400', 'border-emerald-400');
                check.classList.add('hidden');
                status.classList.add('hidden');
            } else {
                // Check item
                checkedItems.add(itemId);
                item.classList.add('checked');
                item.classList.remove('bg-gray-50', 'bg-gray-800');
                checkbox.classList.add('bg-emerald-400', 'border-emerald-400');
                checkbox.classList.remove('border-gray-300', 'border-gray-500', 'bg-white', 'bg-gray-700');
                check.classList.remove('hidden');
                status.classList.remove('hidden');
            }
            
            updateStats();
        }

        // Update statistics
        function updateStats() {
            const total = checklistItems.length;
            const completed = checkedItems.size;
            const pending = total - completed;
            const percentage = Math.round((completed / total) * 100);
            const completedPercentage = total > 0 ? Math.round((completed / total) * 100) : 0;
            const pendingPercentage = total > 0 ? Math.round((pending / total) * 100) : 0;
            
            document.getElementById('total-items').textContent = total;
            document.getElementById('completed-items').textContent = completed;
            document.getElementById('pending-items').textContent = pending;
            document.getElementById('progress-text').textContent = percentage + '%';
            document.getElementById('progress-bar').style.width = percentage + '%';
            
            // Update individual progress bars
            document.getElementById('total-bar').style.width = '100%';
            document.getElementById('completed-bar').style.width = completedPercentage + '%';
            document.getElementById('pending-bar').style.width = pendingPercentage + '%';
        }

        // Reset checklist
        function resetChecklist() {
            if (confirm('Tem certeza que deseja resetar todo o checklist?')) {
                checkedItems.clear();
                const isDark = document.documentElement.classList.contains('dark');
                
                checklistItems.forEach(item => {
                    const itemElement = document.getElementById(`item-${item.id}`);
                    const checkbox = document.getElementById(`checkbox-${item.id}`);
                    const check = document.getElementById(`check-${item.id}`);
                    const status = document.getElementById(`status-${item.id}`);
                    
                    itemElement.classList.remove('checked');
                    if (isDark) {
                        itemElement.style.backgroundColor = '#1F2937';
                        checkbox.style.backgroundColor = '#1F2937';
                        checkbox.style.borderColor = '#94a3b8';
                    } else {
                        itemElement.style.backgroundColor = 'white';
                        checkbox.style.backgroundColor = 'white';
                        checkbox.style.borderColor = '#d1d5db';
                    }
                    checkbox.classList.remove('bg-emerald-400', 'border-emerald-400');
                    check.classList.add('hidden');
                    status.classList.add('hidden');
                });
                updateStats();
                alert('Checklist resetado com sucesso!');
            }
        }

        // Export to Excel
        function exportReport() {
            const date = new Date().toLocaleDateString('pt-BR');
            const total = checklistItems.length;
            const completed = checkedItems.size;
            const percentage = Math.round((completed / total) * 100);
            
            // Create CSV content with table format
            let csvContent = "data:text/csv;charset=utf-8,";
            
            // Header information
            csvContent += "RELAT√ìRIO DE AUDITORIA INDUSTRIAL\n";
            csvContent += `Data:,${date}\n`;
            csvContent += `Total de Itens:,${total}\n`;
            csvContent += `Itens Conclu√≠dos:,${completed}\n`;
            csvContent += `Progresso:,${percentage}%\n\n`;
            
            // Table headers
            csvContent += "ID,Categoria,Item,Status,Crit√©rio de Aceita√ß√£o,Tipo de Defeito,Tipo de Inspe√ß√£o,A√ß√£o Corretiva\n";
            
            // Table data
            checklistItems.forEach(item => {
                const status = checkedItems.has(item.id) ? 'Conclu√≠do' : 'Pendente';
                const row = [
                    item.id,
                    `"${item.category}"`,
                    `"${item.item}"`,
                    status,
                    `"${item.criteria}"`,
                    `"${item.defect}"`,
                    `"${item.inspection}"`,
                    `"${item.action}"`
                ].join(',');
                csvContent += row + "\n";
            });
            
            // Create and download file
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", `Auditoria_Industrial_${date.replace(/\//g, '-')}.csv`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            alert('Relat√≥rio exportado com sucesso! O arquivo ser√° baixado automaticamente.');
        }

        // Show item details modal
        function showItemDetails(itemId) {
            const item = checklistItems.find(i => i.id === itemId);
            if (!item) return;
            
            document.getElementById('modal-title').textContent = item.item;
            
            const detailsHTML = `
                <div class="space-y-4 sm:space-y-6">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6">
                        <div class="bg-gradient-to-br from-purple-50 to-indigo-100 dark:from-purple-900/40 dark:to-indigo-900/40 border border-purple-200 dark:border-purple-700 rounded-xl p-3 sm:p-4 shadow-sm">
                            <h4 class="font-semibold text-purple-800 dark:text-purple-300 mb-2 text-sm sm:text-base">üìã Crit√©rio de Aceita√ß√£o</h4>
                            <p class="text-gray-700 text-sm sm:text-base" style="color: #374151;" data-dark-text="white">${item.criteria}</p>
                        </div>
                        
                        <div class="bg-gradient-to-br from-rose-50 to-pink-100 dark:from-rose-900/40 dark:to-pink-900/40 border border-rose-200 dark:border-rose-700 rounded-xl p-3 sm:p-4 shadow-sm">
                            <h4 class="font-semibold text-rose-800 dark:text-rose-300 mb-2 text-sm sm:text-base">‚ö†Ô∏è Tipo de Defeito</h4>
                            <p class="text-gray-700 text-sm sm:text-base" style="color: #374151;" data-dark-text="white">${item.defect}</p>
                        </div>
                        
                        <div class="bg-gradient-to-br from-amber-50 to-orange-100 dark:from-amber-900/40 dark:to-orange-900/40 border border-amber-200 dark:border-amber-700 rounded-xl p-3 sm:p-4 shadow-sm">
                            <h4 class="font-semibold text-amber-800 dark:text-amber-300 mb-2 text-sm sm:text-base">üîç Tipo de Inspe√ß√£o</h4>
                            <p class="text-gray-700 text-sm sm:text-base" style="color: #374151;" data-dark-text="white">${item.inspection}</p>
                        </div>
                        
                        <div class="bg-gradient-to-br from-emerald-50 to-teal-100 dark:from-emerald-900/40 dark:to-teal-900/40 border border-emerald-200 dark:border-emerald-700 rounded-xl p-3 sm:p-4 shadow-sm">
                            <h4 class="font-semibold text-emerald-800 dark:text-emerald-300 mb-2 text-sm sm:text-base">üîß A√ß√£o Corretiva</h4>
                            <p class="text-gray-700 text-sm sm:text-base" style="color: #374151;" data-dark-text="white">${item.action}</p>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-r from-slate-50 to-gray-100 dark:from-slate-800/50 dark:to-gray-800/50 border border-slate-200 dark:border-slate-600 rounded-xl p-3 sm:p-4 shadow-sm">
                        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-3 sm:space-y-0">
                            <div>
                                <h4 class="font-semibold text-slate-800 dark:text-white mb-1 text-sm sm:text-base">Status da Inspe√ß√£o</h4>
                                <p class="text-xs sm:text-sm text-slate-600" style="color: #475569;" data-dark-text="white">Categoria: ${item.category}</p>
                                ${item.type ? `<p class="text-xs sm:text-sm text-indigo-600 dark:text-indigo-300 font-medium">Tipo: ${item.type}</p>` : ''}
                            </div>
                            <div class="text-center sm:text-right">
                                <div class="text-2xl sm:text-3xl mb-2">
                                    ${checkedItems.has(itemId) ? '‚úÖ' : '‚è≥'}
                                </div>
                                <div class="text-xs sm:text-sm font-semibold px-3 py-1 rounded-full ${checkedItems.has(itemId) ? 'bg-emerald-100 dark:bg-emerald-900/50 text-emerald-700 dark:text-emerald-300' : 'bg-amber-100 dark:bg-amber-900/50 text-amber-700 dark:text-amber-300'}">
                                    ${checkedItems.has(itemId) ? 'Conclu√≠do' : 'Pendente'}
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="text-center">
                        <button onclick="toggleItemFromModal(${itemId})" 
                                class="px-6 sm:px-8 py-3 rounded-xl font-semibold transition-all transform hover:scale-105 shadow-lg text-sm sm:text-base w-full sm:w-auto ${checkedItems.has(itemId) ? 'bg-gradient-to-r from-amber-500 to-orange-500 hover:from-amber-600 hover:to-orange-600 text-white' : 'bg-gradient-to-r from-emerald-500 to-teal-500 hover:from-emerald-600 hover:to-teal-600 text-white'}">
                            ${checkedItems.has(itemId) ? '‚Ü©Ô∏è Marcar como Pendente' : '‚úÖ Marcar como Conclu√≠do'}
                        </button>
                    </div>
                </div>
            `;
            
            document.getElementById('item-details-content').innerHTML = detailsHTML;
            document.getElementById('item-modal').classList.remove('hidden');
            document.getElementById('item-modal').classList.add('flex');
        }

        // Toggle item from modal
        function toggleItemFromModal(itemId) {
            toggleItem(itemId);
            showItemDetails(itemId); // Refresh modal content
        }

        // Close item modal
        function closeItemModal() {
            document.getElementById('item-modal').classList.add('hidden');
            document.getElementById('item-modal').classList.remove('flex');
        }

        // Close modal
        function closeModal() {
            document.getElementById('report-modal').classList.add('hidden');
            document.getElementById('report-modal').classList.remove('flex');
        }

        // Print checklist
        function printChecklist() {
            const date = new Date().toLocaleDateString('pt-BR');
            const total = checklistItems.length;
            const completed = checkedItems.size;
            const percentage = Math.round((completed / total) * 100);
            
            // Create print content
            let printContent = `
                <html>
                <head>
                    <title>Relat√≥rio de Auditoria Industrial</title>
                    <style>
                        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap');
                        body { font-family: 'Montserrat', sans-serif; margin: 20px; }
                        .header { text-align: center; margin-bottom: 30px; }
                        .summary { background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px; }
                        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                        th { background-color: #4f46e5; color: white; font-weight: 600; }
                        .completed { background-color: #d1fae5; }
                        .pending { background-color: #fef3c7; }
                        .category-header { background-color: #e5e7eb; font-weight: 600; }
                        @media print { body { margin: 0; } }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>Relat√≥rio de Auditoria Industrial</h1>
                        <p>Sistema de Checklist - Auditoria de Itens Industriais</p>
                    </div>
                    
                    <div class="summary">
                        <h3>Resumo da Auditoria</h3>
                        <p><strong>Data:</strong> ${date}</p>
                        <p><strong>Total de Itens:</strong> ${total}</p>
                        <p><strong>Itens Conclu√≠dos:</strong> ${completed}</p>
                        <p><strong>Progresso:</strong> ${percentage}%</p>
                    </div>
                    
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Categoria</th>
                                <th>Item</th>
                                <th>Status</th>
                                <th>Crit√©rio de Aceita√ß√£o</th>
                                <th>Tipo de Defeito</th>
                                <th>Tipo de Inspe√ß√£o</th>
                                <th>A√ß√£o Corretiva</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            // Group items by category for better organization
            const categories = {};
            checklistItems.forEach(item => {
                if (!categories[item.category]) {
                    categories[item.category] = [];
                }
                categories[item.category].push(item);
            });
            
            // Add table rows grouped by category
            Object.keys(categories).forEach(category => {
                printContent += `<tr class="category-header"><td colspan="8"><strong>${category}</strong></td></tr>`;
                categories[category].forEach(item => {
                    const status = checkedItems.has(item.id) ? 'Conclu√≠do' : 'Pendente';
                    const statusClass = checkedItems.has(item.id) ? 'completed' : 'pending';
                    printContent += `
                        <tr class="${statusClass}">
                            <td>${item.id}</td>
                            <td>${item.category}</td>
                            <td>${item.item}</td>
                            <td><strong>${status}</strong></td>
                            <td>${item.criteria}</td>
                            <td>${item.defect}</td>
                            <td>${item.inspection}</td>
                            <td>${item.action}</td>
                        </tr>
                    `;
                });
            });
            
            printContent += `
                        </tbody>
                    </table>
                </body>
                </html>
            `;
            
            // Open print window
            const printWindow = window.open('', '_blank');
            printWindow.document.write(printContent);
            printWindow.document.close();
            printWindow.focus();
            printWindow.print();
        }

        // Dark mode functionality
        function toggleDarkMode() {
            const html = document.documentElement;
            const body = document.body;
            const isDark = html.classList.contains('dark');
            const icon = document.getElementById('dark-mode-icon');
            
            if (isDark) {
                // Switch to light mode
                html.classList.remove('dark');
                body.classList.remove('dark');
                body.style.backgroundColor = 'white';
                icon.textContent = 'üåô';
                localStorage.setItem('darkMode', 'false');
                applyLightMode();
            } else {
                // Switch to dark mode
                html.classList.add('dark');
                body.classList.add('dark');
                body.style.backgroundColor = '#1E293B';
                icon.textContent = '‚òÄÔ∏è';
                localStorage.setItem('darkMode', 'true');
                applyDarkMode();
            }
            
            // Force update all dynamic elements
            updateDarkModeElements();
        }

        // Apply light mode colors
        function applyLightMode() {
            const elementsWithDarkBg = document.querySelectorAll('[data-dark-bg]');
            elementsWithDarkBg.forEach(element => {
                element.style.backgroundColor = 'white';
            });
            
            const elementsWithDarkBorder = document.querySelectorAll('[data-dark-border]');
            elementsWithDarkBorder.forEach(element => {
                element.style.borderColor = '#d1d5db';
            });
            
            // Reset card borders to light mode colors
            const cardElements = document.querySelectorAll('.bg-white.dark\\:bg-slate-700, .bg-white.dark\\:bg-slate-600, .checklist-item');
            cardElements.forEach(element => {
                element.style.borderColor = '#e5e7eb'; // Light gray border for light mode
            });
            
            // Update text colors
            updateTextColors();
        }

        // Apply dark mode colors
        function applyDarkMode() {
            const elementsWithDarkBg = document.querySelectorAll('[data-dark-bg]');
            elementsWithDarkBg.forEach(element => {
                const darkBg = element.getAttribute('data-dark-bg');
                if (darkBg) {
                    element.style.backgroundColor = darkBg;
                }
            });
            
            const elementsWithDarkBorder = document.querySelectorAll('[data-dark-border]');
            elementsWithDarkBorder.forEach(element => {
                const darkBorder = element.getAttribute('data-dark-border');
                if (darkBorder) {
                    element.style.borderColor = darkBorder;
                }
            });
            
            // Apply #374151 border to all cards in dark mode
            const cardElements = document.querySelectorAll('.bg-white.dark\\:bg-slate-700, .bg-white.dark\\:bg-slate-600, .checklist-item');
            cardElements.forEach(element => {
                element.style.borderColor = '#374151';
            });
            
            // Update text colors
            updateTextColors();
        }

        // Update all dynamic elements for dark mode
        function updateDarkModeElements() {
            const isDark = document.documentElement.classList.contains('dark');
            
            // Update all checklist items
            checklistItems.forEach(item => {
                const itemElement = document.getElementById(`item-${item.id}`);
                const checkbox = document.getElementById(`checkbox-${item.id}`);
                
                if (itemElement && !checkedItems.has(item.id)) {
                    if (isDark) {
                        itemElement.style.backgroundColor = '#1F2937';
                    } else {
                        itemElement.style.backgroundColor = 'white';
                    }
                }
                
                if (checkbox && !checkedItems.has(item.id)) {
                    if (isDark) {
                        checkbox.style.backgroundColor = '#1F2937';
                        checkbox.style.borderColor = '#94a3b8';
                    } else {
                        checkbox.style.backgroundColor = 'white';
                        checkbox.style.borderColor = '#d1d5db';
                    }
                }
            });
            
            // Update text colors for dark mode
            updateTextColors();
        }
        
        // Update text colors based on dark mode
        function updateTextColors() {
            const isDark = document.documentElement.classList.contains('dark');
            const elementsWithDarkText = document.querySelectorAll('[data-dark-text]');
            
            elementsWithDarkText.forEach(element => {
                if (isDark) {
                    const darkTextColor = element.getAttribute('data-dark-text');
                    if (darkTextColor && darkTextColor !== 'white') {
                        element.style.setProperty('color', darkTextColor, 'important');
                    } else {
                        element.style.setProperty('color', 'white', 'important');
                    }
                } else {
                    // Reset to original colors for light mode
                    if (element.textContent.includes('üìã Detalhes')) {
                        element.style.color = '#3b82f6';
                    } else if (element.closest('h3')) {
                        element.style.color = '#1f2937';
                    } else {
                        element.style.color = '#374151';
                    }
                }
            });
        }

        // Initialize dark mode from localStorage
        function initializeDarkMode() {
            const darkMode = localStorage.getItem('darkMode');
            const icon = document.getElementById('dark-mode-icon');
            const html = document.documentElement;
            const body = document.body;
            
            if (darkMode === 'true' || darkMode === null) {
                html.classList.add('dark');
                body.classList.add('dark');
                body.style.backgroundColor = '#1E293B';
                icon.textContent = '‚òÄÔ∏è';
                setTimeout(() => applyDarkMode(), 50);
            } else {
                html.classList.remove('dark');
                body.classList.remove('dark');
                body.style.backgroundColor = 'white';
                icon.textContent = 'üåô';
                setTimeout(() => applyLightMode(), 50);
            }
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            initializeDarkMode();
            initializeChecklist();
            // Update dark mode elements after checklist is initialized
            setTimeout(() => {
                updateDarkModeElements();
            }, 100);
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96d35818d1ff23ac',t:'MTc1NDg2OTI4OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
